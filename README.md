# 酷毙了（伪计算机病毒）

在大约十年前，我还在使用Windows XP系统。有一次我从腾讯QQ上收到了好友发来的一个程序，程序名叫“酷毙了”，在打开这个文件后，电脑屏幕显示的画面会开始向右移动并在左侧循环出现，并且移动得越来越快，最终快速的滑动使画面变得模糊而难以操作，只能重启电脑。这看起来只是一个整人的程序，因为我的电脑似乎没有被破坏或入侵的迹象。后来我时不时会想起它，并试过在网上搜索它的原版，但是直到我复刻这个程序时，我还没能找到它。于是我决定试着重现它。

---

## 使用方法

1️⃣ 编译整个项目或下载 `酷毙了.exe`，将其放在任意 Windows 10/11 系统中运行。  
2️⃣ 双击运行后，桌面画面将开始向右滑动，鼠标跟随视觉移动。移动速度会变得越来越快，难以操作。
3️⃣ 若需要退出程序，连续快速按下 `End` 键两次，程序会弹出退出确认窗口。确认后，程序将自动恢复系统光标与桌面状态。

---

## 注意事项

- 程序仅供娱乐和学习目的，切勿用于恶意用途。
- 退出后为了打开被禁用的交互，explorer.exe将会重启，已经打开的文件夹会被关闭。
- 请确保已保存好重要工作，防止程序占用资源导致电脑卡死！

---

## 实现原理

由于个人本领有限，没能直接操作显存实现画面改造（这涉及底层对显示驱动的操作）。这个项目完全通过WINDOWS API实现，本质是一个能显示这种移动的画面的大的置顶窗口。
具体是窗口设置为 `WS_EX_LAYERED | WS_EX_TRANSPARENT | WS_EX_TOPMOST`，实现鼠标穿透与焦点锁定；使用 `Magnification API` 捕获桌面图像，在透明全屏窗口中实时绘制经过偏移的屏幕内容，制造滑动假象；使用 `UI Automation` 获取鼠标指向的控件类型，绘制与原生系统光标匹配的虚拟光标，同时隐藏原有光标（不然光标不能跟随画面移动）；自动检测鼠标进入任务视图按钮，模拟 ESC 快速关闭悬浮窗（悬浮窗优先级高于一切程序，总会浮现在程序上方让用户看破）；


---

## 已知问题

- 任务管理器中仍可见进程（尽管图标和名字可以伪装）。
- 屏幕移动效果依赖显卡性能，较旧电脑上可能会产生卡顿。
- 部分安全软件可能将其识别为“潜在恶意软件”进行拦截。但是我可以保证不会破坏文件、不会植入进程、不会自动传播。软件没有涉及联网的功能，理应也不会弹出“是否允许设备更改您的电脑”的弹窗。

---

## 💡 致谢

感谢年少时遇见的整蛊程序“酷毙了”留下的深刻印象，它让我至今都对计算机充满好奇。

---

> 🎯 欢迎 Star 本项目！如果有人因为“酷毙了”这个名字找到这里，那我会很开心的。如果有人找到真正的酷毙了，希望您联系我！
